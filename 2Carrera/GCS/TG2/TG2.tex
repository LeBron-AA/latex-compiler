\documentclass{article}
\usepackage{enumitem}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{tikz}
\usetikzlibrary{3d, perspective}

%Cambiar "Figure" a "Figura"
\renewcommand{\figurename}{Figura}
\renewcommand{\figureautorefname}{Figura}

\title{TG II}   
\author{
    Javier Ortín Rodenas \\
    Bruno Martín Rivera \\
    Jorge Gota Ortín \\
    Alejandra Sánchez Mayo
}
\date{}
\begin{document}
\maketitle
\noindent
\section{Enunciado:}
Un toro es la superficie de revolución generada por una circunferencia al girar alrededor de un eje situado en su mismo plano y que no la corta.\\
Sean $a, b \in \mathbb{R}$ con $0<a<b$.\\
Consideremos el toro cuya curva generatriz es la circunferencia de centro
en el punto $(a, 0,0)$ y radio $b$ situada en el plano $y=0$.
Dicha circunferencia gira alrededor del eje $z$.\\[2ex]

\begin{enumerate}[label=(\roman*)]
    \item Usando como parámetros $u \in(0,2 \pi)$, ángulo de giro del punto inicial respecto del eje $x, y$ $v \in(0,2 \pi)$, ángulo de giro de dicho punto respecto del eje z, obtener una parametrización del toro, como superficie de revolución, de la forma
    $$
    \begin{aligned}
        X: U=(0,2 \pi) \times(0,2 \pi) \subseteq \mathbb{R}^{2} & \longrightarrow \mathbb{R}^{3} \\
        (u, v) & \longmapsto X(u, v)=(x(u, v), y(u, v), z(u, v))
    \end{aligned}
    $$
    
    \item Con ayuda de dicha parametrización, obtener una ecuación cartesiana de la superficie generada, es decir, de modo que el toro se pueda expresar en la forma
    
    $$
    \mathbb{T}=\left\{(x, y, z) \in \mathbb{R}^{3}: F(x, y, z)=0\right\}
    $$
    
    \noindent donde $F$ es una función que hay que determinar.\\

\item Determinar si $X$ es una carta del toro de clase $C^{k}(k \geq 1)$.\\
\item Determinar el plano tangente al toro $y$ el vector unitario normal en cada punto regular $p=X(q), \hspace{1mm} q \in U$ del soporte $X(U)$

\end{enumerate}

\section{Solución}
\subsection{Primer apartado}
\hspace{1mm} Para parametrizar el toro, podemos centrarnos primero en parametrizar la curva
generatriz para posteriormente modelar el proceso de revolución. En este caso,
la curva generatriz es una circunferencia de centro $(a,0,0)$ y radio $b$
contenida en el plano $y = 0$.

\begin{figure}[htbp]
\begin{center}
    \begin{tikzpicture}[scale=1.2]
        % Axes
        \draw[->] (0,0) -- (7,0) node[right] {$x$}; % X-axis
        \draw[->] (0,0) -- (0,3) node[left] {$z$}; % Z-axis
        \draw[->] (0,0) -- (0,-3);
        
        % Circle with center at (a,0)
        \draw[thick] (4,0) circle(1); % Circumference
        \node[below] at (4,0) {\small{$(a,0,0)$}}; %Labeling the center
        
        %Drawing a point of the circumference
        \draw[red, thick] (4,0) -- ++(45:1); %Radius
        \filldraw (4,0) circle(2pt);  % Center point
        \node[left, red] at (4.3, 0.5) {$b$}; %b text
        \filldraw[red] (4.7071,0.7071) circle(1.5pt); %Dotting the point
        \node[anchor=south west] at (4.7071,0.7071) {\small{$\big(a + b \cos(u),0,b \sin(u)\big)$}}; %Labeling the point

        %Drawing the angle arch
        \draw[thick, blue] (4.4,0) arc[start angle=0, end angle=45, radius=0.4];
        \node[blue, anchor = south west] at (4.4,0) {$u$};

        %Radius
        \draw[green, <->] (0,0.7071) -- (4.7071,0.7071);
        \node[green, above] at (2.35355, 0.7071) {$a +b\cos(u)$};

        %Height
        \draw[cyan,thick, <->] (0.7,0) -- (0.7,0.7071);
        \node[cyan, right] at (0.7, 0.35) {$b \sin(u)$};

    \end{tikzpicture}
\end{center}
\caption{Representación de la circunferencia generatriz en el plano $y = 0$}
\label{fig1}
\end{figure}

Hemos utilizado coordenadas polares para parametrizar la circunferencia generatriz.
En este caso, el radio de la circunferencia es $b$, luego es el coeficiente que
multiplica al seno y al coseno del ángulo que forma cada punto con el eje $x$. Como la circunferencia
se encuentra en el plano $y = 0$, la segunda componente tiene valor constante $0$. Finalmente,
sumamos las coordenadas del centro $(a, 0, 0)$ para obtener la parametrización final de la 
curva generatriz. \vspace{1mm}

Queda parametrizar ahora el proceso de revolución. Como el eje de giro es el eje $z$, el radio
de revolución de un punto de la circunferencia será su distancia hasta él; es decir, su componente $x$.
El resultado final del proceso de revolución tendrá  la misma coordenada $z$ que el punto que lo generó.
No obstante, las componentes $x$ e $y$ se verán modificadas según el ángulo de giro.
\vspace{1mm}

Sea $(x_0, 0, z_0)$ un punto cualquiera de la circunferencia generatriz, los puntos del toro resultantes
de su revolución son los de la circunferencia de centro $(0,0,z_0)$ y radio $x_0$ en el plano $z = z_0$.
Razonando así para cada punto de la generatriz llegamos a la parametrización final del toro.

Veamos un ejemplo gráfico del proceso de revolución para un punto dado.
Fijado el punto de la \autoref{fig1}, veamos qué sucede al girarlo sobre el eje $z$.
La siguiente representación coincide con el escenario supuesto, pues $0 < b < a$ por hipótesis,
lo que garantiza que la generatriz no corte al eje de giro.

\newcommand{\mycircle}[3] % Círculo tangente al vector x, y, z
{%
  \pgfmathsetmacro\vtheta{atan2(#2,#1)}                     % spherical coordinate theta
  \pgfmathsetmacro\vphi  {acos(#3/sqrt(#1*#1+#2*#2+#3*#3))} % spherical coordinate phi
  \begin{scope}[rotate around z=\vtheta,rotate around y=\vphi,canvas is xy plane at z=0]
    \draw (-0.5,-0.5) rectangle (0.5,0.5);
    \draw[fill=gray,fill opacity=0.2] (0,0) circle (0.5);   % the plane, probably not needed
  \end{scope}
}


\begin{figure}[h!]
    \begin{center}
    \begin{tikzpicture}[scale=2]
        % Axes
        \draw[->] (0,0,0) -- (4,0,0) node[right] {$x$};  % x-axis
        \draw[->] (0,0,0) -- (0,0,4) node[below right] {$y$};  % y-axis
        \draw[->] (0,0,0) -- (0,2.5,0) node[above] {$z$};  % z-axis
        \draw[->, dotted] (0,0,0) -- (0,-2.5,0);

        %Generatriz 1
        \begin{scope}[canvas is xy plane at z=0]
            \draw (2,0) circle (0.75cm);
            \filldraw (2,0) circle (1pt);
          \end{scope}

        %Generatriz 2
        \begin{scope}[canvas is zy plane at x=0]
            \draw (2,0) circle (0.75cm);
            \filldraw (2,0) circle (1pt);
          \end{scope}

        %Revolución
        \begin{scope}[canvas is xz plane at y=0]
            \draw[thick, blue] (2,0) arc[start angle=0, end angle=90, radius=2];
        \end{scope}

        \begin{scope}[canvas is xz plane at y=0.75]
        \draw[thick, red] (2,0) arc[start angle=0, end angle=90, radius=2];
        \end{scope}

        \begin{scope}[canvas is xz plane at y=-0.75]
        \draw[thick, red] (2,0) arc[start angle=0, end angle=90, radius=2];
        \end{scope}

        \begin{scope}[canvas is xz plane at y=0]
        \draw[green] (2.75,0) arc[start angle=0, end angle=90, radius=2.75];
        \end{scope}

        \begin{scope}[canvas is xz plane at y=0]
        \draw[dotted,green] (1.25,0) arc[start angle=0, end angle=90, radius=1.25];
        \end{scope}


        %Radios
        \draw[thick, dotted] (0,0.75,0) -- (2,0.75,0);
        \draw[thick, dotted] (0,0.75,0) -- (0,0.75,2);
        \node[above] at (0.9,0.75,0) {$a + b\cos (u)$};

        %Parámetro ángulo
        \begin{scope}[canvas is xz plane at y=0.75]
            \draw[dotted, thick] (0.5,0) arc[start angle=0, end angle=90, radius=0.5];
            \node at (0.5, 0.5) {$v$};
        \end{scope}
    \end{tikzpicture}
\end{center}
    \caption{Giro sobre el eje $z$ de la generatriz en el primer cuadrante}
\end{figure}

\vspace{4ex}

\noindent Por todo lo anterior, la parametrización del toro es la siguiente:
$$
    \begin{aligned}
        X: U&= (0,2 \pi) \times(0,2 \pi) \subseteq \mathbb{R}^{2}  \longrightarrow \mathbb{R}^{3} \\
        (u,& v)  \longmapsto  X(u, v)= \Big(\big(a + b \cos(u)\big)\cos(v),
                \hspace{1mm} \big(a + b \cos(u)\big)\sin(v),
                \hspace{1mm}b \sin(u)\Big)
    \end{aligned}
$$

\newpage

\subsection{Segundo apartado}
\hspace{1mm} Veamos cómo definir el toro parametrizado en el apartado anterior con una ecuación cartesiana.
Es decir, buscamos que no aparezcan los parámetros $u$ y $v$, sino que solo
intervengan las variables $x,y,z$.
Planteamos el siquiente sistema para después obtener una única ecuación:

\[
\hspace{-7cm} % Adjust this value as needed
\left\{
\begin{aligned}
x &= \Big(a + b \cos(u)\Big) \cos(v) \\
y &= \Big(a + b \cos(u)\Big) \sin(v) \\
z &= b \sin(u)
\end{aligned}
\right.
\]
\\
\noindent Relacionamos las ecuaciones del sistema mediante identidades trigonométricas:
\begin{flalign*}
    x^2 + y^2 &= \Big(a + b \cos(u)\Big)^2 \cos^2(v)
    + \Big(a + b \cos(u)\Big)^2 \sin^2(v) =\\
    = & \Big(a + b \cos(u)\Big)^2 = a^2 + 2ab \cos(u) + b^2 \cos^2(u)
\end{flalign*}

$$ x^2 + y^2 + z^2 = a^2 + 2ab \cos(u) + b^2 \cos^2(u) + b^2 \sin^2(u) = a^2 + 2ab \cos(u) + b^2$$
\\
\noindent Notamos que el coseno sigue presente, de manera similar a cómo ocurría en la expresión de $x^2 + y^2$.
Buscamos definir el toro a partir de esta correlación.

$$(x^2+y^2+z^2+a^2-b^2)^2 = \left(2a^2 + 2ab \cos(u) \right)^2 = 4a^4 + 4a^3b \cos(u) + 4a^2b^2 \cos^2(u)$$
\\
\noindent Finalmente, sacando factor común obtenemos la ecuación cartesiana del toro:

$$ (x^2+y^2+z^2+a^2-b^2)^2 = 4a^2(a^2 + 2ab \cos(u) + b^2\cos^2(u)) = 4a(x^2 + y^2)$$
\\ \noindent
Por todo lo anterior, si definimos la siguiente función, podremos escribir el toro como su conjunto de ceros.

$$
    \begin{aligned}
        F: \mathbb{R}^3& \longrightarrow \mathbb{R} \\
        (x,& y, z)  \longmapsto  F(x, y, z)= (x^2+y^2+z^2+a^2-b^2)^2 - 4a(x^2 + y^2)
    \end{aligned}
$$
$$\mathbb{T} = \left\{(x,y,z) \in \mathbb{R}^3 :F(x,y,z) = 0\right\}$$
    

\newpage

\subsection{Tercer apartado}
\hspace{1mm} Para comprobar que $X$ es una carta de clase $\mathcal{C}^k (k\geq1)$,
han de verificarse simultáneamente las siguientes condiciones:
\begin{itemize}
    \item $X$ es de clase $\mathcal{C}^k$
    \item $X : U \longrightarrow X(U)$ es un homeomorfismo con la topología heredada
    \item $d(X)(u,v) $ tiene rango 2 $ \hspace{1.5mm} \forall (u,v) \in U$
\end{itemize}

\vspace{2mm}
Veamos que $X$ no es una carta al comprobar que su matriz Jacobiana (y por tanto su diferencial) no siempre
tiene rango máximo. Para ello, mostraremos un contraejemplo donde la diferencial
de $X$ no tiene rango 2. Podemos comprobarlo al calcular el determinante de las
submatrices cuadradas de su matriz Jacobiana.

\[
J_X(u,v) =
\begin{pmatrix}
-b \sin(u) \cos(v) & -\big(a + b\cos(u) \big) \sin(v)\\[2ex]
-b \sin(u) \sin(v) & \big(a + b \cos(u) \big) \cos(v)\\[2ex]
b \cos(u) & 0
\end{pmatrix}
\]
\\[2ex]
\noindent Veamos qué ocurre para el punto $(u,v) = (\pi, \frac{\pi}{2}) \in (0, 2\pi) \times (0, 2\pi) = U$.
\[
J_X(\pi,\pi) =
\begin{pmatrix}
-b \cos(v) & -a\sin(v)\\[2ex]
-b\sin(v) & a \cos(v) \\[2ex]
0 & 0
\end{pmatrix}
\]
En estas condiciones, es evidente que los determinantes de las submatrices cuadradas
son todos nulos. Por tanto, $r\big(J_X(\pi, \pi)\big) \neq 2$, lo que demuestra que $X$
no es una carta. 
\end{document}